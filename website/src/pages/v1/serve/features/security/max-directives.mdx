import { Callout } from '@theguild/components'

# Max Directives

<Callout>
  This page is currently under construction and expected to change. Please feel free to reach out to
  us directly in case you are having any troubles.
</Callout>

**Limit** the number of **directives** in a GraphQL document.

It is used to prevent **DOS attack**, **heap overflow** or **server overloading**.

[Provided by GraphQL Armor](https://escape.tech/graphql-armor/docs/plugins/max-directives)

## How to use?

Install the plugin:

```sh npm2yarn
npm install @escape.tech/graphql-armor-max-directives
```

Then, add it to your plugins:

```ts filename="mesh.config.ts"
import { maxDirectivesPlugin } from '@escape.tech/graphql-armor-max-directives'
import { defineConfig as defineServeConfig } from '@graphql-mesh/serve-cli'

export default defineServeConfig({
  plugins: () => [
    maxDirectivesPlugin({
      // Toggle the plugin | Default: true
      enabled: true,
      // Number of directives allowed | Default: 10
      n: 10,
      // Do you want to propagate the rejection to the client? | default: true
      propagateOnRejection: true,
      // List of queries that are allowed to bypass the plugin
      allowList: [],

      /* Advanced options (use here on your own risk) */

      // Callbacks that are ran whenever a Query is accepted
      onAccept: [],

      // Callbacks that are ran whenever a Query is rejected
      onReject: []
    })
  ]
})
```

## References

- https://github.com/graphql-java/graphql-java/issues/2888
- https://github.com/graphql-java/graphql-java/pull/2892
